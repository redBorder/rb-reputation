package net.redborder.malware.utils;

public class IPUtils {
    
    /**
     * Check whether the input IP is in the range of private networks 
     * 
     * <li> Class A: 10.0.0.0 ------- 10.255.255.255 </li>
     * <li> Class B: 172.16.0.0 ---- 172.31.255.255 </li>
     * <li> Class C: 192.168.0.0 --- 192.168.255.255 </li>
     *
     * @param ip String with the IP to check.
     * @return true if the IP is private. Otherwise, returns false.
     */
    public static boolean isPrivateNetwork(String ip) {
        Integer sub_ip = Integer.valueOf(ip.substring(0, ip.indexOf(".")));
        boolean isPrivate = false;
        switch (sub_ip) {
            case 10:
                isPrivate = true;
                break;
            case 172:
                sub_ip = Integer.valueOf(ip.substring(4, ip.indexOf(".", 4)));
                if (sub_ip >= 16 && sub_ip < 32)
                    isPrivate = true;
                break;
            case 192:
                sub_ip = Integer.valueOf(ip.substring(4, ip.indexOf(".", 4)));
                if (sub_ip.equals(168))
                    isPrivate = true;
                break;
        }
        return isPrivate;
    }
}