package net.redborder.malware.modules.data;

import java.util.Map;
import java.util.concurrent.CountDownLatch;

public interface DataModule extends Runnable{

    enum Operation{
        FULL, INCREMENTAL, QUERY
    }

    enum QUERY_PARAM {
        HASH("hash"), IP("ip"), URL("url");

        public String value;

        QUERY_PARAM(String value) {
            this.value = value;
        }
    }

    enum FullDataType {
        HASH("hash"), IP("ip"), URL("url"), TOTAL("total");

        public String value;

        FullDataType(String value){
            this.value = value;
        }
    }

    void init();

    void prepareQuery(Map<String, Object> parameters);

    Object doQuery();
    Object getFullData();
    Object getIncremental();

    Object getOperationResult();

    void shutdown();
    void reload();
    void selectOperation(Operation operation);
    void selectFullDataType(FullDataType fullDataType);

    String getDataModuleName();

    void addLatch(CountDownLatch latch);

    Map<String, Object> processQueryURL(String URL);
    Map<String, Object> processQueryHash(String hash);
    Map<String, Object> processQueryIP(String IP);

}
