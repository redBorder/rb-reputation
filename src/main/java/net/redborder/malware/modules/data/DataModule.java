package net.redborder.malware.modules.data;

import java.util.Map;
import java.util.concurrent.CountDownLatch;

public interface DataModule extends Runnable{

    enum Operation{
        FULL, INCREMENTAL, QUERY
    }

    enum QUERY_PARAM {
        HASH("hash"), IP("ip"), URL("url");

        public String value;

        QUERY_PARAM(String value) {
            this.value = value;
        }
    }

    enum FullDataType {
        HASH, IP, URL, TOTAL
    }

    void init();

    void prepareQuery(Map<String, Object> parameters);

    Object doQuery();
    Object getFullData(FullDataType type);
    Object getIncremental();

    Object getOperationResult();

    void shutdown();

    void selectOperation(Operation operation);

    String getDataModuleName();

    void addLatch(CountDownLatch latch);

    Map<String, Object> processQueryURL(String URL);
    Map<String, Object> processQueryHash(String hash);
    Map<String, Object> processQueryIP(String IP);

}
