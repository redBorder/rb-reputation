package net.redborder.malware.tasks;

public class StandardTaskMonitor implements TaskMonitor {

    protected String currentTaskDescription;
    protected volatile boolean cancelFlag = false;
    protected volatile boolean pauseFlag = false;
    protected volatile boolean isComplete = false;

    @Override
    public void setCurrentActivityDescription(String description) {
        this.currentTaskDescription = description;
    }

    @Override
    public String getCurrentActivityDescription() {
        return this.currentTaskDescription;
    }

    @Override
    public void requestPause() {
        this.pauseFlag = true;
    }

    @Override
    public synchronized void requestResume() {
        this.pauseFlag = false;
        notify();
    }

    @Override
    public void requestCancel() {
        this.cancelFlag = true;
        requestResume();
    }

    @Override
    public boolean isPaused() {
        return this.pauseFlag;
    }

    @Override
    public boolean isCancelled() {
        return this.cancelFlag;
    }

    @Override
    public boolean taskShouldAbort() {

        if (this.pauseFlag) {
            try {
                synchronized (this) {
                    while (this.pauseFlag && !this.cancelFlag) {
                        wait();
                    }
                }
            } catch (InterruptedException e) {
            }
        }

        return this.cancelFlag;
    }
}
